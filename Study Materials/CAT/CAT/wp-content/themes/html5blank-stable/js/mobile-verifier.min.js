function otpValidation(e,r,s){var a=jQuery(e),i=a.val(),n="message",o=/^\d{4}$/,t=/^\d{1,4}$/,d=i.match(t),l=d&&d.length>=1&&d[0];return a.siblings(".input-error-msg").remove(),i.match(t)?i&&null!==i?i.match(o)?(n="",e[0].parameterName="otp"):n="OTP should be 4 digits.":n="OTP is required.":(a.val(l),n="Enter only numbers."),n?(a.addClass("input-error").removeClass("input-valid"),a.after('<div class="input-error-msg">'+n+"</div>"),!1):(a.removeClass("input-error"),a.addClass("input-valid"),!0)}function phoneNumberValidation(e,r,s,a,i,n,o=""){MOBILE_OTP_VALIDATER.isPhoneNumberVerified=!1,phoneNumberFromSendOtpResponse="";var t,d,l,p,_,T=jQuery(e),m=T.find("[data-phone-number-input]"),u=T.find("[data-otp-number-input]"),f=T.find("[data-otp-input-field-voice-call-option]"),E=T.find("[data-send-otp]"),A=T.attr("name"),O=jQuery(e).find("[data-otp-validated-img]"),v=jQuery("[data-remaining-fields-container]"),c="",g={};E.click(function(){if("undefined"!=typeof USER_DETAILS_INPUT_VALIDATORS?USER_DETAILS_INPUT_VALIDATORS.phoneValidation(m):UTILITIES.phoneValidation(m)){var e=m.val(),p={phoneNumber:e};if(""==o){if("IAS_QUESTIONS"==n?(c="DEFAULT_IAS_USER_LOCALSTORAGE",g=DEFAULT_IAS_USER_DETAILS):"blc-form"===n||"job-posting-form"===n||"sales-acknowledgement-form"===n||"service-counsel"===n||"blc-popup-form"===n?g.verifyKey=generateRandomID():"open-close-rank-jee-main"==n||"jee-neet-talk-to-counselor-form"==n||"sidebar-join-byjus-form"==n||"cat-rank-predictor"===n||"ias-register-now-pop-up-form"==n||"cat-register-now-pop-up-form"==n||(c="DEFAULT_COMMENT_BOX_LOCALSTORAGE",g=DEFAULT_USER_DETAILS),null!==getStorage(c))if(userFromStorage=JSON.parse(getStorage(c)),userFromStorage.verifyKey){var _=new Date,T=("0"+_.getFullYear()).slice(-2)+""+("0"+(_.getMonth()+1)).slice(-2)+("0"+_.getDate()).slice(-2);userFromStorage.verifyKey.substring(17,23)==T?g.verifyKey=userFromStorage.verifyKey:g.verifyKey=generateRandomID()}else g.verifyKey=generateRandomID();else"blc-form"===n||"job-posting-form"===n||"sales-acknowledgement-form"===n||"service-counsel"===n||"blc-popup-form"===n||("open-close-rank-jee-main"==n?(g.verifyKey=generateRandomID(),MOBILE_OTP_VALIDATER.storageSessionId=g.verifyKey):g.verifyKey=generateRandomID());"IAS_QUESTIONS"==n?DEFAULT_IAS_USER_DETAILS.verifyKey=g.verifyKey:"blc-form"===n||"job-posting-form"===n||"sales-acknowledgement-form"===n||"service-counsel"===n||"blc-popup-form"===n||"open-close-rank-jee-main"==n||"open-close-rank-neet-main"==n||"jee-neet-talk-to-counselor-form"==n||"sidebar-join-byjus-form"==n||"ias-register-now-pop-up-form"==n||"cat-register-now-pop-up-form"==n||(DEFAULT_USER_DETAILS.verifyKey=g.verifyKey),p.verifyKey=g.verifyKey}o?p.page=A:p.type=A,m.addClass("sending");var I=30;E.attr("disabled",!0),E.html('<div class="otp-active-timer" data-otp-active-timer>Resend in <span>'+I+"</span>sec.</div>"),t=setInterval(function(){--I,I<=0&&(clearInterval(t),E.attr("disabled",!1),E.html("Resend OTP"),m.siblings(".input-error-msg").remove()),E.find("[data-otp-active-timer] span").html(I)},1e3),u.attr("disabled",!1).focus();var D=o?MOBILE_OTP_VALIDATER.apis.bcasSendOtp:MOBILE_OTP_VALIDATER.apis.sendOtp,L=o?0:"undefined"==typeof WT_OTP_ENCRYPTION_ENABLED_VAL||"undefined"==typeof WT_OTP_ENCRYPTED_DATA_AUTH_TOKEN_VAL||"undefined"==typeof WT_OTP_ENCRYPTED_DATA_KEY_VAL||"undefined"==typeof OTP_ENCRYPT_PAYLOAD_WT||0==WT_OTP_ENCRYPTION_ENABLED_VAL||""==WT_OTP_ENCRYPTED_DATA_AUTH_TOKEN_VAL||""==WT_OTP_ENCRYPTED_DATA_KEY_VAL?0:WT_OTP_ENCRYPTION_ENABLED_VAL;0==L||1==L&&OTP_ENCRYPT_PAYLOAD_WT.isTokenValid(OTP_ENCRYPT_PAYLOAD_WT.getToken())?jQuery.ajax({type:"POST",url:D,data:1==L?JSON.parse(OTP_ENCRYPT_PAYLOAD_WT.sendEncryptedData(JSON.stringify(p))):p,success:function(o,p,_){d=_.getResponseHeader("isverified"),l=_.getResponseHeader("reference-id"),MOBILE_OTP_VALIDATER.verifyToken="Bearer "+_.getResponseHeader("reference-id"),MOBILE_OTP_VALIDATER.verifyReference=_.getResponseHeader("reference-id"),MOBILE_OTP_VALIDATER.mobileNumber=e,o&&"error"===o.status?CS_UTILITIES.addToastMessage(0,"Something went wrong. Please try after some time"):o?"true"===d?(m.after('<div class="input-error-msg" style="color:green;">'+o.message+"</div>"),E.addClass("d-none").addClass("hidden"),f.addClass("d-none").addClass("hidden"),m.attr("disabled",!0),m.addClass("otp-verified"),u.attr("disabled",!0),m.siblings(".input-error-msg").remove(),MOBILE_OTP_VALIDATER.isPhoneNumberVerified=!0,O.removeClass("hidden"),clearInterval(t),E.html("Send OTP"),E.attr("disabled",!1),"PDF_DOWNLOAD"===n&&v.length>0?(GA_FLAG&&ga("send","event","PDF downloaded successfully","PDF downloaded successfully","PDF downloaded successfully"),inputFieldManaged(e,r,s,a,i,n),v.removeClass("hidden")):"COMMENT"==n?inputFieldManaged(e,r,s,a,i,n):"alliance-form"===n?enableSliderInAllianceForm():"COMMENT"==n?inputFieldManaged(e,r,s,a,i,n):"open-close-rank-jee-main"===n?userCheckIfAlreadyExist(e,r,s,a,i,n):"IAS_QUESTIONS"==n&&void 0!==r&&void 0!==s?inputFieldManaged(e,r,s,a="",i="",n):"YOUTUBE_LIVE_VIDEO_REDIRECTION"===n&&v.length>0?(GA_FLAG&&ga("send","event","YouTube live video redirection is successful","YouTube live video redirection is successful","YouTube live video redirection is successful"),inputFieldManaged(e,r,s,a,i,n),v.removeClass("hidden")):"PDF_DOWNLOAD_LEAD_FORM_MODAL"===n&&v.length>0&&v.removeClass("hidden")):(f.removeClass("d-none").removeClass("hidden"),phoneNumberFromSendOtpResponse=o.number,E.addClass("resend"),MOBILE_OTP_VALIDATER.isPhoneNumberVerified=!1,m.after('<div class="input-error-msg" style="color:green;">OTP has been Sent to <b>'+e+"</b></div>"),"PDF_DOWNLOAD"===n&&v.length>0||"COMMENT"==n||"VIDEO"==n||"alliance-form"==n||"open-close-rank-jee-main"===n||"YOUTUBE_LIVE_VIDEO_REDIRECTION"===n&&v.length>0||"PDF_DOWNLOAD_LEAD_FORM_MODAL"===n&&v.length):CS_UTILITIES.addToastMessage(0,"Something went wrong. Please try after some time")},error:function(e,r,s){m.removeClass("sending"),m.siblings(".input-error-msg").remove(),m.after('<div class="input-error-msg">'+e.responseJSON.message+"</div>")}}):CS_UTILITIES.addToastMessage(0,"Session Expired")}else phoneNumberValidation(m)}),u.on("input",function(){if(!MOBILE_OTP_VALIDATER.isPhoneNumberVerified&&(u.siblings(".input-error-msg").remove(),this.isValid=otpValidation(u),this.isValid)){params={phoneNumber:phoneNumberFromSendOtpResponse,otp:u.val()},o?params.page=A:(params.type=A,params.Authorization="Bearer "+l),m.siblings(".input-error-msg").remove(),u.siblings(".input-error-msg").remove(),u.removeClass("input-error");var e=o?MOBILE_OTP_VALIDATER.apis.bcasVerifyOtp:MOBILE_OTP_VALIDATER.apis.verifyOtp,d=o?0:"undefined"==typeof WT_OTP_ENCRYPTION_ENABLED_VAL||"undefined"==typeof WT_OTP_ENCRYPTED_DATA_AUTH_TOKEN_VAL||"undefined"==typeof WT_OTP_ENCRYPTED_DATA_KEY_VAL||"undefined"==typeof OTP_ENCRYPT_PAYLOAD_WT||0==WT_OTP_ENCRYPTION_ENABLED_VAL||""==WT_OTP_ENCRYPTED_DATA_AUTH_TOKEN_VAL||""==WT_OTP_ENCRYPTED_DATA_KEY_VAL?0:WT_OTP_ENCRYPTION_ENABLED_VAL;0==d||1==d&&OTP_ENCRYPT_PAYLOAD_WT.isTokenValid(OTP_ENCRYPT_PAYLOAD_WT.getToken())?jQuery.ajax({type:"POST",url:e,data:1==d?JSON.parse(OTP_ENCRYPT_PAYLOAD_WT.sendEncryptedData(JSON.stringify(params))):params,beforeSend:function(e){o&&e.setRequestHeader("Authorization","Bearer "+l)},success:function(e,d,l){if(o)E.addClass("d-none").addClass("hidden"),f.addClass("d-none").addClass("hidden"),m.attr("disabled",!0),m.addClass("otp-verified"),u.attr("disabled",!0),m.siblings(".input-error-msg").remove(),O.removeClass("hidden"),MOBILE_OTP_VALIDATER.isPhoneNumberVerified=!0,clearInterval(t),E.html("Send OTP"),E.attr("disabled",!1),"alliance-form"===n&&enableSliderInAllianceForm();else if(p=l.getResponseHeader("otpverified"),"true"===p)if(E.addClass("d-none").addClass("hidden"),f.addClass("d-none").addClass("hidden"),m.attr("disabled",!0),m.addClass("otp-verified"),u.attr("disabled",!0),m.siblings(".input-error-msg").remove(),O.removeClass("hidden"),MOBILE_OTP_VALIDATER.isPhoneNumberVerified=!0,clearInterval(t),"blc-form"!=n&&"job-posting-form"!==n&&"service-counsel"!==n||setTimeout(function(){automateApplyNow()},1e3),E.html("Send OTP"),E.attr("disabled",!1),"PDF_DOWNLOAD"===n&&v.length>0)v.removeClass("hidden"),inputFieldManaged(m.val(),r,s,a,i,n);else if("COMMENT"==n)inputFieldManaged(m.val(),r,s,a,i,n);else if("VIDEO"==n)inputFieldManaged(m.val(),r,s,a,i,n);else if("IAS_QUESTIONS"===n)inputFieldManaged(m.val(),r,s,a="",i="",n);else if("COMMENT"==n)r.removeClass("hidden"),s.removeClass("hidden"),a.removeClass("hidden"),i.removeClass("hidden");else if("open-close-rank-jee-main"===n)userCheckIfAlreadyExist(m.val(),r,s,a,i,n);else if("YOUTUBE_LIVE_VIDEO_REDIRECTION"===n&&v.length>0)v.removeClass("hidden"),inputFieldManaged(m.val(),r,s,a,i,n);else if("PDF_DOWNLOAD_LEAD_FORM_MODAL"===n&&v.length>0)v.removeClass("hidden");else if("jee-neet-talk-to-counselor-form"==n)jQuery("[data-phone-number-input]").removeClass("input-error"),jQuery("[data-otp-validated-img]").removeClass("hidden");else if("sidebar-join-byjus-form"==n){let e=jQuery("#join-byjus-form-widget");e.find("[data-phone-number-input]").removeClass("input-error"),e.find("[data-phone-number-input]").addClass("input-valid"),e.find("[data-otp-validated-img]").removeClass("hidden")}else"ias-register-now-pop-up-form"==n?(jQuery("[data-phone-number-input]").removeClass("input-error"),jQuery("[data-otp-validated-img]").removeClass("hidden")):"cat-register-now-pop-up-form"==n&&(jQuery("[data-phone-number-input]").removeClass("input-error"),jQuery("[data-otp-validated-img]").removeClass("hidden"));else u.removeClass("input-error"),u.siblings(".input-error-msg").remove(),u.addClass("input-error"),u.after('<div class="input-error-msg">'+e.message+"</div>");"INTERACTIVE_QUIZ"==n&&checkexistinguser(params.phoneNumber,"","","","","INTERACTIVE_QUIZ")},error:function(e,r,s){var a;a=void 0!==e.responseJSON?e.responseJSON.message:e.statusText,u.removeClass("input-error"),u.siblings(".input-error-msg").remove(),u.addClass("input-error"),u.after('<div class="input-error-msg">'+a+"</div>")}}):CS_UTILITIES.addToastMessage(0,"Session Expired")}});var I=T.find("[data-otp-voice-call-cta]");I.on("click",function(){var e=jQuery(this),r=30;e.find("span").html(" <b>"+r+"</b>sec."),e.attr("disabled",!0),u.attr("disabled",!1).focus(),_=setInterval(function(){--r,r<=0?(clearInterval(_),e.find("span").html("Voice Call"),e.attr("disabled",!1)):e.find("span").html(" <b>"+r+"</b>sec.")},1e3)})}var MOBILE_OTP_VALIDATER={isPhoneNumberVerified:!1,isUserAlreadyExist:!1,mobileNumber:"",verifyToken:"",verifyReference:"",apis:{register:BCAS_API_BASE_URL+"api/acs/v1/register",sendOtp:COMMON_UTILS_ENDPOINT_KEY+"otp",pageInstanse:"ask-question-popup",verifyOtp:COMMON_UTILS_ENDPOINT_KEY+"otp-verify",bcasSendOtp:BCAS_API_BASE_URL+"api/acs/v2/send-otp",bcasVerifyOtp:BCAS_API_BASE_URL+"api/acs/v2/verify-otp",voiceOtp:BCAS_API_BASE_URL+"api/acs/voice"},storageSessionId:""};